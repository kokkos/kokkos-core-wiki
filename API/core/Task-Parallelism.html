<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Atomics" href="atomics.html" /><link rel="prev" title="Space Accessibility" href="SpaceAccessibility.html" />

    <meta name="generator" content="sphinx-5.0.1, furo 2022.06.04.1"/>
        <title>Task-Parallelism - Kokkos documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/hacks.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Kokkos  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Kokkos  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../programmingguide.html">Programming Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Machine-Model.html">2. Machine Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/ProgrammingModel.html">3: Programming Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Compiling.html">4. Compiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Initialization.html">5. Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/View.html">6: View: Multidimensional array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/ParallelDispatch.html">7. Parallel dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/HierarchicalParallelism.html">8. Hierarchical Parallelism</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../ProgrammingGuide/Custom-Reductions.html">9. Custom Reductions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ProgrammingGuide/Custom-Reductions-Built-In-Reducers.html">9.1 Built-In-Reducers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ProgrammingGuide/Custom-Reductions-Built-In-Reducers-with-Custom-Scalar-Types.html">9.2 Built-In Reducers with Custom Scalar Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ProgrammingGuide/Custom-Reductions-Custom-Reducers.html">9.3 Custom Reducers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Atomic-Operations.html">10. Atomic Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Subviews.html">11: Subviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Compatibility.html">12 Backwards &amp; Future Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Interoperability.html">13. Interoperability and Legacy Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProgrammingGuide/Kokkos-and-Virtual-Functions.html">14. Kokkos and Virtual Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building.html">Build, Install and Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../keywords.html">CMake Keywords</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../core-index.html">API: Core</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="Initialize-and-Finalize.html">Initialize and Finalize</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="initialize_finalize/initialize.html">initialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="initialize_finalize/finalize.html">finalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="initialize_finalize/ScopeGuard.html">ScopeGuard</a></li>
<li class="toctree-l3"><a class="reference internal" href="initialize_finalize/InitializationSettings.html">InitializationSettings</a></li>
<li class="toctree-l3"><a class="reference internal" href="initialize_finalize/InitArguments.html">InitArguments</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="View.html">View and related</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="view/create_mirror.html"><code class="docutils literal notranslate"><span class="pre">create_mirror[_view]</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/deep_copy.html"><code class="docutils literal notranslate"><span class="pre">deep_copy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/layoutLeft.html"><code class="docutils literal notranslate"><span class="pre">LayoutLeft</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/layoutRight.html"><code class="docutils literal notranslate"><span class="pre">LayoutRight</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/layoutStride.html"><code class="docutils literal notranslate"><span class="pre">LayoutStride</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/realloc.html"><code class="docutils literal notranslate"><span class="pre">realloc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/resize.html"><code class="docutils literal notranslate"><span class="pre">resize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/subview.html"><code class="docutils literal notranslate"><span class="pre">subview</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/view.html"><code class="docutils literal notranslate"><span class="pre">View</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/view_alloc.html"><code class="docutils literal notranslate"><span class="pre">view_alloc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="view/view_like.html">View-like Types</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="ParallelDispatch.html">Parallel Execution/Dispatch</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/parallel_for.html"><code class="docutils literal notranslate"><span class="pre">parallel_for()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/parallel_reduce.html"><code class="docutils literal notranslate"><span class="pre">parallel_reduce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/parallel_scan.html"><code class="docutils literal notranslate"><span class="pre">parallel_scan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/fence.html"><code class="docutils literal notranslate"><span class="pre">fence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/ParallelForTag.html"><code class="docutils literal notranslate"><span class="pre">ParallelForTag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/ParallelReduceTag.html"><code class="docutils literal notranslate"><span class="pre">ParallelReduceTag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel-dispatch/ParallelScanTag.html"><code class="docutils literal notranslate"><span class="pre">ParallelScanTag()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="builtin_reducers.html">Built-in Reducers</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/ReducerConcept.html"><code class="docutils literal notranslate"><span class="pre">ReducerConcept</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/BAnd.html"><code class="docutils literal notranslate"><span class="pre">BAnd</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/BOr.html"><code class="docutils literal notranslate"><span class="pre">BOr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/LAnd.html"><code class="docutils literal notranslate"><span class="pre">LAnd</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/LOr.html"><code class="docutils literal notranslate"><span class="pre">LOr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/Max.html"><code class="docutils literal notranslate"><span class="pre">Max</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/MaxLoc.html"><code class="docutils literal notranslate"><span class="pre">MaxLoc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/Min.html"><code class="docutils literal notranslate"><span class="pre">Min</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/MinLoc.html"><code class="docutils literal notranslate"><span class="pre">MinLoc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/MinMax.html"><code class="docutils literal notranslate"><span class="pre">MinMax</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/MinMaxLoc.html"><code class="docutils literal notranslate"><span class="pre">MinMaxLoc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/Prod.html"><code class="docutils literal notranslate"><span class="pre">Prod</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="builtinreducers/Sum.html"><code class="docutils literal notranslate"><span class="pre">Sum</span></code></a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="builtinreducers/ReductionScalarTypes.html">Reduction Scalar Types</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="builtinreducers/MinMaxLocScalar.html"><code class="docutils literal notranslate"><span class="pre">MinMaxLocScalar</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="builtinreducers/MinMaxScalar.html"><code class="docutils literal notranslate"><span class="pre">MinMaxScalar</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="builtinreducers/ValLocScalar.html"><code class="docutils literal notranslate"><span class="pre">ValLocScalar</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="Execution-Policies.html">Execution Policies</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="policies/ExecutionPolicyConcept.html"><code class="docutils literal notranslate"><span class="pre">ExecutionPolicy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/MDRangePolicy.html"><code class="docutils literal notranslate"><span class="pre">MDRangePolicy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/NestedPolicies.html"><code class="docutils literal notranslate"><span class="pre">NestedPolicies</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/RangePolicy.html"><code class="docutils literal notranslate"><span class="pre">RangePolicy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/TeamHandleConcept.html"><code class="docutils literal notranslate"><span class="pre">TeamHandleConcept</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/TeamPolicy.html"><code class="docutils literal notranslate"><span class="pre">TeamPolicy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/TeamThreadRange.html"><code class="docutils literal notranslate"><span class="pre">TeamThreadRange</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/TeamVectorRange.html"><code class="docutils literal notranslate"><span class="pre">TeamVectorRange</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="policies/ThreadVectorRange.html"><code class="docutils literal notranslate"><span class="pre">ThreadVectorRange</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="Spaces.html">Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="execution_spaces.html">Execution Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory_spaces.html">Memory Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="SpaceAccessibility.html">Space Accessibility</a></li>
</ul>
</li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Task-Parallelism</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="atomics.html">Atomics</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_compare_exchange.html"><code class="docutils literal notranslate"><span class="pre">atomic_compare_exchange</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_compare_exchange_strong.html"><code class="docutils literal notranslate"><span class="pre">atomic_compare_exchange_strong</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_exchange.html"><code class="docutils literal notranslate"><span class="pre">atomic_exchange</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_fetch_op.html"><code class="docutils literal notranslate"><span class="pre">atomic_fetch_[op]</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_load.html"><code class="docutils literal notranslate"><span class="pre">atomic_load</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_op.html"><code class="docutils literal notranslate"><span class="pre">atomic_[op]</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_op_fetch.html"><code class="docutils literal notranslate"><span class="pre">atomic_[op]_fetch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomics/atomic_store.html"><code class="docutils literal notranslate"><span class="pre">atomic_store</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="Numerics.html">Numerics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="numerics/mathematical-constants.html">Mathematical constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerics/mathematical-functions.html">Common math functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerics/numeric-traits.html">Numeric traits</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="c_style_memory_management.html">C-style memory management</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="c_style_memory_management/malloc.html"><code class="docutils literal notranslate"><span class="pre">kokkos_malloc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="c_style_memory_management/realloc.html"><code class="docutils literal notranslate"><span class="pre">kokkos_realloc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="c_style_memory_management/free.html"><code class="docutils literal notranslate"><span class="pre">kokkos_free</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Traits.html">Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="KokkosConcepts.html">Kokkos Concepts</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="STL-Compatibility.html">STL Compatibility Issues</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="stl-compat/pair.html"><code class="docutils literal notranslate"><span class="pre">Kokkos::pair</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="Utilities.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities/abort.html"><code class="docutils literal notranslate"><span class="pre">Kokkos::abort</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities/complex.html"><code class="docutils literal notranslate"><span class="pre">Kokkos::complex</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities/timer.html"><code class="docutils literal notranslate"><span class="pre">Kokkos::Timer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities/experimental.html"><code class="docutils literal notranslate"><span class="pre">Kokkos::Experimental</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Detection-Idiom.html">Detection Idiom</a></li>
<li class="toctree-l2"><a class="reference internal" href="Macros.html">Macros</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../containers-index.html">API: Containers</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../containers/Bitset.html"><code class="docutils literal notranslate"><span class="pre">Bitset</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/Bitset.html#constbitset"><code class="docutils literal notranslate"><span class="pre">ConstBitset</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/DualView.html"><code class="docutils literal notranslate"><span class="pre">DualView</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/DynamicView.html"><code class="docutils literal notranslate"><span class="pre">DynamicView</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/DynRankView.html"><code class="docutils literal notranslate"><span class="pre">DynRankView</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/Offset-View.html"><code class="docutils literal notranslate"><span class="pre">OffsetView</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/ScatterView.html"><code class="docutils literal notranslate"><span class="pre">ScatterView</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/StaticCrsGraph.html"><code class="docutils literal notranslate"><span class="pre">StaticCrsGraph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/Unordered-Map.html"><code class="docutils literal notranslate"><span class="pre">UnorderedMap</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../containers/vector.html"><code class="docutils literal notranslate"><span class="pre">vector</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../algorithms-index.html">API: Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../algorithms/Random-Number.html">Random-Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algorithms/Random-Number.html#generator">Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algorithms/Sort.html">Sort</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../algorithms/std-algorithms-index.html">Std Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/Iterators.html">Iterators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/StdMinMaxElement.html">Minimum/maximum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/StdModSeq.html">Modifying Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/StdNonModSeq.html">NonModifying Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/StdNumeric.html">Numeric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/StdPartioningOps.html">Partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/std-algorithms/StdSorting.html">Sorting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../alphabetical.html">API in Alphabetical Order</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usecases.html">Use Cases and Examples</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/MPI-Halo-Exchange.html">MPI Halo Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/Average-To-Nodes.html">ScatterView averaging elements to nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/MDRangePolicy.html">MDRangePolicy Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/VirtualFunctions.html">Virtual Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/TaggedOperators.html">Tagged Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/OverlappingHostAndDeviceWork.html">Overlapping Host and Device work</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/Tasking.html">Kokkos Tasking Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/Kokkos-Fortran-Interoperability.html">Fortran Interop Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usecases/SoA-and-AoSoA-with-Cabana.html">Array of Structures and Structure of Arrays with Cabana</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../testing-and-issue-tracking.html">Testing and Issue Tracking</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../testing-and-issue-tracking/Requirements-Issues-and-Feedback.html">Requirements, Issues and Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing-and-issue-tracking/Testing-Process-Details.html">Attachments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing-and-issue-tracking/Testing-Processes.html">Kokkos Testing Processes and Change Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing-and-issue-tracking/Testing-Workflow-Components.html">Kokkos Testing Workflow Components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kokkos/kokkos-tutorials">Tutorials</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../videolectures.html">Video lectures</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=rUIcWtFU5qM">1. Intro, Build, Parallel dispatch</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=O-asHTtO7O4">2. Views and Spaces</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=nGyJS8u-6GY">3. Multidim loops and Data Structures</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=s9ecpeWRePs">4. Hierarchical Parallelism</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=xEAyOod57-c">5. SIMD, Streams, Tasking</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=1J3JQ3d3cRc&amp;t=1s">6. Fortran/Python interop, MPI, PGAS</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=MH6zFYGw0HU">7. Kokkos Tools</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.youtube.com/watch?v=_qD4X66MQF8&amp;t=1s">8. Kokkos Kernels Math Library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kokkos/kokkos">GitHub Repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citation.html">Citing Kokkos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
<div class="edit-this-page">
  <a class="muted-link" href="https://github.com/kokkos/kokkos-core-wiki/blob/main/docs/source/API/core/Task-Parallelism.md" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4"></path>
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div>

          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="task-parallelism">
<h1>Task-Parallelism<a class="headerlink" href="#task-parallelism" title="Permalink to this heading">#</a></h1>
<p>Kokkos has support for lightweight task-based programming, which is currently pretty limited but we plan to substantially expand in the future.</p>
<section id="will-kokkos-tasking-work-for-my-problem">
<h2>Will Kokkos Tasking work for my problem?<a class="headerlink" href="#will-kokkos-tasking-work-for-my-problem" title="Permalink to this heading">#</a></h2>
<p>Not all task-based problems are a good fit for the current Kokkos approach to tasking.  Currently, the tasking interface in Kokkos is  targetted at problems with kernels far too small to overcome the inherent overhead of top-level Kokkos data parallel launches—that is, small but plentiful data parallel tasks with a non-trivial dependency structure.  For tasks that fit this general scale model but have (very) trivial dependency structures, it may be easier to use <a class="reference internal" href="../../ProgrammingGuide/HierarchicalParallelism.html"><span class="doc std std-doc">hierarchical parallelism</span></a>, potentially with a <code class="docutils literal notranslate"><span class="pre">Kokkos::Schedule&lt;Dynamic&gt;</span></code> scheduling policy (see, for instance, <a class="reference internal" href="policies/RangePolicy.html"><span class="doc std std-doc">this page</span></a>) for load balancing if necessary.</p>
</section>
<section id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this heading">#</a></h2>
<p>Fundamentally, task parallelism is just another form of parallelism in Kokkos.  The same general idiom of pattern, policy, and functor applies as for ordinary <a class="reference internal" href="../../ProgrammingGuide/ParallelDispatch.html"><span class="doc std std-doc">parallel dispatch</span></a>:</p>
<p><img alt="parallel-dispatch" src="https://raw.githubusercontent.com/wiki/kokkos/kokkos/ProgrammingGuide/figures/parallel-dispatch.png" /></p>
<p>Similarly, for tasking, we have:</p>
<p><img alt="task-dispatch" src="https://raw.githubusercontent.com/wiki/kokkos/kokkos/ProgrammingGuide/figures/task-dispatch.png" /></p>
</section>
<section id="task-functor">
<h2>Task Functor<a class="headerlink" href="#task-functor" title="Permalink to this heading">#</a></h2>
<p>In most ways, the functor portion of the task parallelism idiom in Kokkos is similar to that for data parallelism.  Task functors haeve the additional requirement that the task output type needs to be provided by the user by giving a nested type (a.k.a. “typedef”) named <code class="docutils literal notranslate"><span class="pre">value_type</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">MyTask</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">value_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">TeamMember</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="n">TeamMember</span><span class="o">&amp;</span><span class="w"> </span><span class="n">member</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">&amp;</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>Similar to <a class="reference internal" href="../../ProgrammingGuide/HierarchicalParallelism.html"><span class="doc std std-doc">team parallelism</span></a>, the first parameter is the team handle, which has all of the same functionality as the one produced by a <code class="docutils literal notranslate"><span class="pre">Kokkos::TeamPolicy</span></code>, with a few extras.  Like with <code class="docutils literal notranslate"><span class="pre">Kokkos::parallel_reduce()</span></code>, the output is expressed through the second parameter.  Note that there is currently no lambda interface to Kokkos Tasking.</p>
</section>
<section id="task-patterns">
<h2>Task Patterns<a class="headerlink" href="#task-patterns" title="Permalink to this heading">#</a></h2>
<p>The primary analogs of <code class="docutils literal notranslate"><span class="pre">Kokkos::parallel_for()</span></code> and friends for tasking are <code class="docutils literal notranslate"><span class="pre">Kokkos::task_spawn()</span></code> and <code class="docutils literal notranslate"><span class="pre">Kokkos::host_spawn()</span></code>.  They both return a <code class="docutils literal notranslate"><span class="pre">Kokkos::Future</span></code> associated with the appropriate <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code>, but <code class="docutils literal notranslate"><span class="pre">host_spawn</span></code> can only be called from <em>outside</em> of a task functor, while <code class="docutils literal notranslate"><span class="pre">task_spawn</span></code> can only be called from <em>inside</em> of one.</p>
</section>
<section id="task-policies">
<h2>Task Policies<a class="headerlink" href="#task-policies" title="Permalink to this heading">#</a></h2>
<p>There are currently two task policies in Kokkos Tasking: <code class="docutils literal notranslate"><span class="pre">TaskSingle</span></code> and <code class="docutils literal notranslate"><span class="pre">TaskTeam</span></code>.  The former tells Kokkos to launch the associated task functor with a single worker when its predecessors are done (more on this below), while the latter tells Kokkos to launch with a team of workers, similar to a single team from a <code class="docutils literal notranslate"><span class="pre">Kokkos::TeamPolicy</span></code> launch in data parallelism.  In a task spawned with <code class="docutils literal notranslate"><span class="pre">TaskTeam</span></code>, users are only allowed to call <code class="docutils literal notranslate"><span class="pre">task_spawn</span></code> from a single worker; use <code class="docutils literal notranslate"><span class="pre">Kokkos::single</span></code> for this purpose.</p>
</section>
<section id="predecessors-and-schedulers">
<h2>Predecessors and Schedulers<a class="headerlink" href="#predecessors-and-schedulers" title="Permalink to this heading">#</a></h2>
<p>Dependency relationships in Kokkos are represented by instances of the <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> class template.  Each task (created with the <code class="docutils literal notranslate"><span class="pre">task_spawn</span></code> or <code class="docutils literal notranslate"><span class="pre">host_spawn</span></code> patterns) can have zero or one predecessors (to create task graphs with more predecessors, use <code class="docutils literal notranslate"><span class="pre">Kokkos::when_all</span></code>, described below).  Predecessors are given to a pattern as an argument to the policy:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">scheduler_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* ... discussed below ... */</span><span class="p">;</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">scheduler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scheduler_type</span><span class="p">(</span><span class="cm">/* ... discussed below ... */</span><span class="p">);</span><span class="w"></span>
<span class="c1">// Launch with no predecessor:</span>
<span class="k">auto</span><span class="w"> </span><span class="n">fut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">host_spawn</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">TaskSingle</span><span class="p">(</span><span class="n">scheduler</span><span class="p">),</span><span class="w"></span>
<span class="w">  </span><span class="n">MyTaskFunctor</span><span class="p">()</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
<span class="c1">// Launch when `fut` is ready, at the earliest:</span>
<span class="k">auto</span><span class="w"> </span><span class="n">fut2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">host_spawn</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">TaskSingle</span><span class="p">(</span><span class="n">scheduler</span><span class="p">,</span><span class="w"> </span><span class="n">fut</span><span class="p">),</span><span class="w"></span>
<span class="w">  </span><span class="n">MyOtherTaskFunctor</span><span class="p">()</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
<span class="cm">/* ... */</span><span class="w"></span>
</pre></div>
</div>
<p>The Kokkos <code class="docutils literal notranslate"><span class="pre">TaskScheduler</span></code> concept is an abstraction that generalizes over the many possible strategies for scheduling tasks in a task-based system.  Like other concepts in Kokkos, users should not write code that depends directly on a specific <code class="docutils literal notranslate"><span class="pre">TaskScheduler</span></code>, but rather to the generic model that all <code class="docutils literal notranslate"><span class="pre">TaskScheduler</span></code> types guarantee.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> class template, used for representing dependency relationships, is templated on the return type of the task it represents and on the type of the scheduler that was used to execute that task:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Scheduler</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">my_function</span><span class="p">(</span><span class="n">Scheduler</span><span class="w"> </span><span class="n">sched</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// use auto until you need to name the type for some reason</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">fut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">host_spawn</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">TaskSingle</span><span class="p">(</span><span class="n">sched</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">MyTaskFunctor</span><span class="p">()</span><span class="w"></span>
<span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* ... */</span><span class="w"></span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">my_result_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyTaskFunctor</span><span class="o">::</span><span class="n">value_type</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="c1">// convertibility is guaranteed:</span>
<span class="w">  </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">BasicFuture</span><span class="o">&lt;</span><span class="n">my_task_result</span><span class="p">,</span><span class="w"> </span><span class="n">Scheduler</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fut</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>(Note: Kokkos does not guarantee the specific return type of task parallel patterns, only that they will be convertible to the appropriate <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> type.  Use <code class="docutils literal notranslate"><span class="pre">auto</span></code> until you need to name the type for some reason—like storing it in a container, for instance.  Otherwise, Kokkos may be able to provide better performance if the future type is never required to be converted to a specific <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> type.)</p>
<p><code class="docutils literal notranslate"><span class="pre">TaskScheduler</span></code> types in Kokkos have shared reference semantics; a copy of a given scheduler represents the same underlying entity and strategy as the scheduler it was copied from. Inside of a task functor, users should retrieve the scheduler instance from the team member handle passed in as the first argument rather than storing the scheduler themselves.  Use <code class="docutils literal notranslate"><span class="pre">auto</span></code> for this as well until you need to store it for some reason.</p>
<p>When a future is ready, the result of the task that a future represents as a predecessor can be retrieved using the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method.  However, this can <strong>only</strong> be called from a context where the future is guaranteed to be ready—that is, in a task that was spawned with the future as a predecessor, or a task that transitively depends on that future via another task, or after a <code class="docutils literal notranslate"><span class="pre">Kokkos::wait</span></code> on the scheduler that spawned the task associated with the future (see below).  <strong>Calling the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method of a future in any other context results in undefined behavior</strong> (and the worst kind of bug, at that: it may not even result in a segfault or anything until hours of execution!).  Note that this is different from <code class="docutils literal notranslate"><span class="pre">std::future</span></code>, where the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method blocks until it’s ready.</p>
<p>Future types in Kokkos have shared reference semantics; a copy of a given future represents the same underlying dependency as the future it was copied from.  A default-constructed <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> represents an always-ready dependency with no value (that is, retrieving the value is undefined behavior—practically speaking, probably a segfault).  A default-constructed future will return <code class="docutils literal notranslate"><span class="pre">true</span></code> for the <code class="docutils literal notranslate"><span class="pre">is_null()</span></code> method.  In addition to convertibility to a <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> of the appropriate value type and scheduler type, all Kokkos futures are convertible to a <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> of <code class="docutils literal notranslate"><span class="pre">void</span></code> and the appropriate scheduler type.</p>
</section>
<section id="waiting-in-kokkos-tasking">
<h2>Waiting in Kokkos Tasking<a class="headerlink" href="#waiting-in-kokkos-tasking" title="Permalink to this heading">#</a></h2>
<p>Kokkos generally provides no way to block a thread of execution to wait on an individual future, and it provides no guarantee of correct execution if the user attempts to do so via external means (for instance, polling on the <code class="docutils literal notranslate"><span class="pre">is_ready()</span></code> method in a <code class="docutils literal notranslate"><span class="pre">while</span></code> loop is forbidden).  <em>Outside of</em> a Kokkos task functor (that is, anywhere that <code class="docutils literal notranslate"><span class="pre">host_spawn</span></code> would be allowed), Kokkos provides the ability to wait on <em>all</em> of the futures created on a given scheduler (including those created, transitively, by tasks spawned not yet completed, or potentially not even started).  This is done using the <code class="docutils literal notranslate"><span class="pre">Kokkos::wait</span></code> function on the scheduler:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Scheduler</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">my_function</span><span class="p">(</span><span class="n">Scheduler</span><span class="w"> </span><span class="n">sched</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// use auto until you need to name the type for some reason</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">fut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">host_spawn</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">TaskSingle</span><span class="p">(</span><span class="n">sched</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">MyTaskFunctor</span><span class="p">()</span><span class="w"></span>
<span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">wait</span><span class="p">(</span><span class="n">sched</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fut</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="cm">/* ... */</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Users should think of <code class="docutils literal notranslate"><span class="pre">Kokkos::wait</span></code> as an <em>extremely</em> expensive operation (a “sledgehammer”) and use it as sparingly as possible.</p>
<section id="waiting-in-a-task-functor">
<h3>“Waiting” in a task functor<a class="headerlink" href="#waiting-in-a-task-functor" title="Permalink to this heading">#</a></h3>
<p>In Kokkos tasking, all task functors must be able to run to completion without blocking once they are started (the Kokkos scheduler <em>can</em> run other tasks at any point that the functor calls back into the Kokkos tasking system, such as any <code class="docutils literal notranslate"><span class="pre">task_spawn</span></code>, but it is allowed to assume user functors will run to completion if left alone).  This means that there is no way to block a task pending the result of another task.  Other tasking systems that make this sort of design decision require the user to spawn a new task for each new piece of predicated work, which is an option in Kokkos as well, but Kokkos also provides another option.  To help reduce the allocation cost associated with the traditional approach to never-blocking task systems, Kokkos allows users to “reuse” the current task as a successor to some future.  Kokkos provides the <code class="docutils literal notranslate"><span class="pre">Kokkos::respawn()</span></code> function.  For example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Scheduler</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">MyTaskFunctor</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">value_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">future_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">BasicFuture</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Scheduler</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">future_type</span><span class="w"> </span><span class="n">f</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">TeamMember</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="n">TeamMember</span><span class="o">&amp;</span><span class="w"> </span><span class="n">member</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">is_null</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">task_spawn</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">TaskSingle</span><span class="p">(</span><span class="n">member</span><span class="p">.</span><span class="n">scheduler</span><span class="p">()),</span><span class="w"></span>
<span class="w">        </span><span class="n">MyOtherTaskFunctor</span><span class="p">()</span><span class="w"></span>
<span class="w">      </span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">respawn</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// This is after the respawn so we&#39;re guaranteed that f is ready</span>
<span class="w">      </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Got result %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>A task functor can only be respawned up to once <em>per execution of</em> <code class="docutils literal notranslate"><span class="pre">operator()</span></code> (that is, once per time it is spawned or respawned).  Multiple calls to <code class="docutils literal notranslate"><span class="pre">respawn</span></code> in the same execution of <code class="docutils literal notranslate"><span class="pre">operator()</span></code> are redundant and lead to undefined behavior.  Calls to <code class="docutils literal notranslate"><span class="pre">respawn</span></code> are always lazy—the subsequent call to <code class="docutils literal notranslate"><span class="pre">operator()</span></code> by Kokkos will only happen after the currently executing one returns (and after the predecessors, if any, are ready) at the earliest.</p>
<p>The first argument to <code class="docutils literal notranslate"><span class="pre">Kokkos::respawn</span></code> must always be a pointer to the currently executing task functor (or one of its base classes) from which <code class="docutils literal notranslate"><span class="pre">Kokkos::respawn</span></code> is called.  The second argument can be either a future of the same scheduler as the currently executing task functor or an instance of the scheduler itself.  The third (optional) argument is a task priority, discussed below.</p>
</section>
</section>
<section id="aggregate-predecessors">
<h2>Aggregate Predecessors<a class="headerlink" href="#aggregate-predecessors" title="Permalink to this heading">#</a></h2>
<p>Kokkos tasking provides two forms of the <code class="docutils literal notranslate"><span class="pre">when_all()</span></code> method on every <code class="docutils literal notranslate"><span class="pre">TaskScheduler</span></code> type. Both serve to aggregate multiple predecessors into one, and both return a value convertible to a <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> of <code class="docutils literal notranslate"><span class="pre">void</span></code> and that scheduler type.  The first takes an array of <code class="docutils literal notranslate"><span class="pre">Kokkos::BasicFuture</span></code> of the scheduler type and a count of entries in that array.  The second takes a <code class="docutils literal notranslate"><span class="pre">count</span></code> and a unary function or functor that should expect to be called with each integer in the range <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">count)</span></code>.  In both cases, the return value is a future that will become ready when all of the input futures become ready.</p>
</section>
<section id="task-priorities">
<h2>Task Priorities<a class="headerlink" href="#task-priorities" title="Permalink to this heading">#</a></h2>
<p>Kokkos allows users to provide a priority hint to task parallel execution policies as an optional third argument, or as an optional third argument to <code class="docutils literal notranslate"><span class="pre">Kokkos::respawn</span></code>.  This has no observable effect on the programming model—only on the performance.  A scheduler may ignore these priorities.  The allowed task priorities are <code class="docutils literal notranslate"><span class="pre">Kokkos::TaskPriority::High</span></code>, <code class="docutils literal notranslate"><span class="pre">Kokkos::TaskPriority::Regular</span></code>, and <code class="docutils literal notranslate"><span class="pre">Kokkos::TaskPriority::Low</span></code>, which the second being the default if the argument isn’t given.</p>
<!--
Invariants in the Kokkos Tasking Programming Model
==================================================

TODO
-->
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="atomics.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Atomics</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="SpaceAccessibility.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Space Accessibility</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2014, National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS)
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Task-Parallelism</a><ul>
<li><a class="reference internal" href="#will-kokkos-tasking-work-for-my-problem">Will Kokkos Tasking work for my problem?</a></li>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li><a class="reference internal" href="#task-functor">Task Functor</a></li>
<li><a class="reference internal" href="#task-patterns">Task Patterns</a></li>
<li><a class="reference internal" href="#task-policies">Task Policies</a></li>
<li><a class="reference internal" href="#predecessors-and-schedulers">Predecessors and Schedulers</a></li>
<li><a class="reference internal" href="#waiting-in-kokkos-tasking">Waiting in Kokkos Tasking</a><ul>
<li><a class="reference internal" href="#waiting-in-a-task-functor">“Waiting” in a task functor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aggregate-predecessors">Aggregate Predecessors</a></li>
<li><a class="reference internal" href="#task-priorities">Task Priorities</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    </body>
</html>